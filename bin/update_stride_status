#!/bin/bash

STATUS="Offline"
if iwgetid | grep -qs 'ESSID:"Charlie'; then
    STATUS="Lvl 9"
elif iwgetid | grep -qs 'ESSID:"Catan'; then
    STATUS="In Transit"
elif iwgetid | grep -qs 'ESSID:"Felix the Cat'; then
    STATUS="WFH"
fi

CLOUD_SESSION_TOKEN="<CLOUD_SESSION_TOKEN_HERE>"

curl 'https://api-private.atlassian.com/chat/site/a436116f-02ce-4520-8fbb-7301462a1674/presence/v3' \
 -X PUT \
 -H "cookie: cloud.session.token=${CLOUD_SESSION_TOKEN}" \
 -H 'content-type: application/json' \
 --data-binary '{"message":"'"${STATUS} $(date +"%a %d %b")"'"}' \
 --compressed
